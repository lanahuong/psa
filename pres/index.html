<!DOCTYPE html>
<html>
<head>
    <title>Presentation template</title>
    <meta charset="utf-8"/>
    <link href="core/fonts/mono.css" rel="stylesheet" type="text/css">
    <link href="core/css/animate.css" rel="stylesheet" type="text/css">
    <link href="core/css/style_core.css" rel="stylesheet" type="text/css">
    <link href="core/css/mermaid.css" rel="stylesheet" type="text/css">
    <link href="core/css/gitgraph.css" rel="stylesheet" type="text/css">
    <link href="core/css/style_ensiie.css" rel="stylesheet" type="text/css">
    <link href="core/css/katex.css" rel="stylesheet" type="text/css">
    <link href="core/css/asciinema-player.css" rel="stylesheet" type="text/css">
</head>
<body>
<textarea id="source" readonly>
class: titlepage

.title[
Projet de PSA
]

.subtitle[
M.Boiteau - M. Migdal - L. Scravaglieri -- ENSIIE -- 2021
]

---

layout: true
class: animated fadeIn middle numbers

.footnote[
Presentation template - N. Dubray - ENSIIE - 2020 - [:book:](./index.html)
]

---

class: toc top
# Table des matières

1. Organisation du projet
    1. Répartition
    2. Arborescence

2. Préprocesseur
    1. Création d'onde
    2. Création du potentiel
    3. Base de donnée

3. Solveur
    1. JSP QUOI DIRE
    2. Relancer une simulation
    3. Monitoring
    4. Paraview (?)

4. Cas physiques
    1. Gaussienne sans potentiel
    2. Oscillateur harmonique
    3. Fentes d'Young


---

# 1.1 Organisation du projet

![](image/deck.png)

---
# 1.2 Arborescence
```
.
├── AUTHORS
├── CMakeLists.txt
├── CMakeLists.txt.in
├── doc
│  └── Doxyfile
├── gtest
├── Makefile
├── pres
├── README.md
```


---
# 1.2 Arborescence


```
.
├── exec
│  └── flup -> ../src/flup/preprocessor.py
│  └── flus -> ../src/flus/solver.py
├── exemples
│  ├── young.png
│  ├── field.png
│  └── json
│     └── gaussien_in_null_field.json
│     └── HO_test.json
│     └── young-splits.json
├── src
│  ├── flup
│  │  ├── gaussian.py
│  │  ├── HO.py
│  │  ├── picture_loader.py
│  │  └── preprocessor.py
│  ├── flus
│  │  ├── modules
│  │  ├── SchemeBTCS.cpp
│  │  ├── SchemeBTCS.h
│  │  ├── SchemeCTCS.cpp
│  │  ├── SchemeCTCS.h
│  │  ├── SchemeFTCS.cpp
│  │  ├── SchemeFTCS.h
│  │  ├── Solver.cpp
│  │  ├── Solver.h
│  │  └── solver.py
│  └── utils
│     └── Repository.py
│     └── db-config.json
└── tests
   ├── modules
   ├── TestSchemeBTCS.cpp
   ├── TestSchemeCTCS.cpp
   └── TestSchemeFTCS.cpp
   └── TestSchemeIntra.cpp```

---

# 2.1 Création d'onde

![](image/gauss_exemple.png)

---

# 2.2 Création du potentiel

VIIIDE

---

# 2.3 Base de données

VIIIDE

---
# 3.1 Interface du solveur

Solveur `flus`, compagnon du préprocesseur `flup`, mêmes fichiers de configuration pour la base de données

--

On lance une (re)simulation avec 
`exec/flus start -n N 'jobName' `

--

* On passe l'intervalle temporel voulu avec `-dt T` en fs.

--

* Possibilité d'utiliser un `supersampling` temporel avec `-s N`

--

* Toutes les frames sont stockées dans mongoDB


---
class: top
# 3.2 Fonctionnement du solveur

- Package python `cd bindings; make && make install`.

--

- Bindings avec Python et dévérouillage du GIL. 

--

- Un interface pour minimiser les transferts de données

--

- Calcul sur des matrices normélisées pour réduire l'erreur numérique

```{C++}
class Solver {

Solver(const arma::cx_mat &phi_0, const arma::mat &pot, double dx, double dy, double dt);

void step();
void step_n(int n);

arma::cx_mat get_phitdt();
double get_norm();
double get_step();
}

``` 

--

- Tests implémentés `$$\forall t, \iint \psi^*(x,y,t).\psi(x,y,t)\,dx\,dy = \iint \psi_0^*(x,y).\psi_0(x,y)\,dx\,dy = 1.$$` 
- Cohérence entre les différents schémas.

---

# 3.3 Monitoring

VIIIDE

---

# 3.4 Paraview

VIIIDE

---

# 4.1 Gaussienne sans potentiel

<video controls="yes" preload="auto" width="100%" height="auto" data-setup="{}" loop>
<source src="videos/nice.webm" type="video/webm" />
</video>

---

# 4.2 Oscillateur harmonique


<video controls="yes" preload="auto" width="100%" height="auto" data-setup="{}" loop>
<source src="videos/videoHO.webm" type="video/webm" />
</video>
---

# 4.3 Fentes d'Young

<video controls="yes" preload="auto" width="100%" height="auto" data-setup="{}" loop>
<source src="videos/young.webm" type="video/webm" />
</video>

---

class: top
# 1 Préprocesseur



--

## Initialisation de la DB :

`flup init`

--

## Remise à zéro de la base de donnée :

`flup reset`

--

## Créer une nouvelle simulation :

`flup new -n "MaSimul" json_file`

---

---


class: top
# 1. Création d'ondes
## Onde Gaussienne
![](image/ragna1.png)

---

class: top
# 1. Création d'ondes
## Normalisation
![](image/ragna2.png)

---

class: top
# 1. Création d'ondes
## Oscillateur harmonique 1D
![](image/ragna3.png)

---
class: top
# 1. Création d'ondes
## Oscillateur harmonique 2D
![](image/ragna4.png)

---
class: top
# 1. Création d'ondes
## Diverses solutions 2D
![](image/ragna5.png)

---
class: top
# 3. Base de données

--

## Collections

- Contexts
    - champ de potentiel
    - dimensions
    - dx
    - dy
    - name
    - context id

--

- Simulations
    - temps simulé
    - frames []
    - context (id du context utilisé)
    - méthode
    - dt
    - run id

---
class: top
# 3. Prochaines actions

--

- terminer les bindings swig

--

- structure du solver

--

- accès à la base de données pour le solver

--

- calculer des simulations complètes


</textarea>

<script src="core/javascript/remark.js"></script>
<script src="core/javascript/katex.min.js"></script>
<script src="core/javascript/auto-render.min.js"></script>
<script src="core/javascript/emojify.js"></script>
<script src="core/javascript/mermaid.js"></script>
<script src="core/javascript/jquery-2.1.1.min.js"></script>
<script src="core/javascript/extend-jquery.js"></script>
<script src="core/javascript/gitgraph.js"></script>
<script src="core/javascript/plotly.js"></script>
<script src="core/javascript/asciinema-player.js"></script>
<script src="core/javascript/bokeh-2.2.1.min.js"></script>
<script src="core/javascript/bokeh-widgets-2.2.1.min.js"></script>
<script src="core/javascript/bokeh-tables-2.2.1.min.js"></script>
<script src="core/javascript/bokeh-api-2.2.1.min.js"></script>

<script>

    // === Remark.js initialization ===
    var slideshow = remark.create(
        {
            highlightStyle: 'monokai',
            countIncrementalSlides: false,
            highlightLines: false
        });

    // === Mermaid.js initialization ===
    mermaid.initialize({
        startOnLoad: false,
        cloneCssStyles: false,
        flowchart: {
            height: 50
        },
        sequenceDiagram: {
            width: 110,
            height: 30
        }
    });

    function initMermaid(s) {
        var diagrams = document.querySelectorAll('.mermaid');
        var i;
        for (i = 0; i < diagrams.length; i++) {
            if (diagrams[i].offsetWidth > 0) {
                mermaid.init(undefined, diagrams[i]);
            }
        }
    }

    slideshow.on('afterShowSlide', initMermaid);
    initMermaid(slideshow.getSlides()[slideshow.getCurrentSlideIndex()]);


    // === Emojify.js initialization ===
    emojify.run();

    // KaTeX
    renderMathInElement(document.body, {
        delimiters: [{left: "$$", right: "$$", display: true}, {left: "$", right: "$", display: false}],
        ignoredTags: ["script", "noscript", "style", "textarea", "pre"]
    });


    // Bokeh.js example #00

    var plt = Bokeh.Plotting;

    var pie_data = {
        labels: ['Work', 'Eat', 'Commute', 'Sport', 'Watch TV', 'Sleep'],
        values: [8, 2, 2, 4, 0, 8],
    };

    var p1 = Bokeh.Charts.pie(pie_data);
    var p2 = Bokeh.Charts.pie(pie_data, {
        inner_radius: 0.2,
        start_angle: Math.PI / 2
    });
    var p3 = Bokeh.Charts.pie(pie_data, {
        inner_radius: 0.2,
        start_angle: Math.PI / 6,
        end_angle: 5 * Math.PI / 6
    });
    var p4 = Bokeh.Charts.pie(pie_data, {
        inner_radius: 0.2,
        palette: "Oranges9",
        slice_labels: "percentages"
    });

    // add the plot to a document and display it
    var doc = new Bokeh.Document();
    doc.add_root(plt.gridplot(
        [[p1, p2], [p3, p4]],
        {plot_width: 250, plot_height: 250}));
    Bokeh.embed.add_document_standalone(doc, document.getElementById("bokeh00"));

    // Bokeh.js example #01

    var plt = Bokeh.Plotting;

    var bar_data = [
        ['City', '2010 Population', '2000 Population'],
        ['NYC', 8175000, 8008000],
        ['LA', 3792000, 3694000],
        ['Chicago', 2695000, 2896000],
        ['Houston', 2099000, 1953000],
        ['Philadelphia', 1526000, 1517000],
    ];

    var p1 = Bokeh.Charts.bar(bar_data, {
        axis_number_format: "0.[00]a"
    });
    var p2 = Bokeh.Charts.bar(bar_data, {
        axis_number_format: "0.[00]a",
        stacked: true
    });
    var p3 = Bokeh.Charts.bar(bar_data, {
        axis_number_format: "0.[00]a",
        orientation: "vertical"
    });
    var p4 = Bokeh.Charts.bar(bar_data, {
        axis_number_format: "0.[00]a",
        orientation: "vertical",
        stacked: true
    });

    var doc = new Bokeh.Document();
    doc.add_root(plt.gridplot(
        [[p1, p2], [p3, p4]],
        {plot_width: 250, plot_height: 250}));
    Bokeh.embed.add_document_standalone(doc, document.getElementById("bokeh01"));

    // ===== END =====

</script>
<script src="gitgraphs.js" type="text/javascript"></script>
</body>
</html>

